{"ast":null,"code":"var _jsxFileName = \"/Users/kenza/Desktop/aDropOfMilk/Front/src/components/Forms/Login.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useFieldArray, useForm } from \"react-hook-form\";\nimport * as yup from \"yup\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport styles from \"./Login.module.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Login({\n  seeHomepage,\n  getUser\n}) {\n  _s();\n  const [feedback, setFeedback] = useState(\"\");\n  const [feedbackGood, setFeedbackGood] = useState(\"\");\n  const yupSchema = yup.object({\n    email: yup.string().required(\"le champ est obligatoire\").email(\"vous devez saisir un email valide\"),\n    password: yup.string().required(\"le champ est obligatoire\")\n  });\n  const defaultValues = {\n    password: \"\",\n    email: \"\"\n  };\n  const {\n    register,\n    handleSubmit,\n    reset,\n    formState: {\n      errors,\n      isSubmitted\n    }\n  } = useForm({\n    defaultValues,\n    mode: \"onChange\",\n    resolver: yupResolver(yupSchema)\n  });\n  const submit = async values => {\n    setFeedback(\"\");\n    console.log(values);\n    const response = await fetch(\"http://localhost:8009/api/users/login\", {\n      method: \"POST\",\n      body: JSON.stringify(values),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    if (response.ok) {\n      const newUser = await response.json();\n      console.log(\"newUser\", newUser);\n      if (newUser.message) {\n        setFeedback(newUser.message);\n      } else {\n        setFeedbackGood(\"Connexion réussie, vous allez être redirigé\");\n        reset(defaultValues);\n        console.log(\"User recupéré\", newUser);\n        let user = {};\n        user.username = newUser[0].username;\n        user.email = newUser[0].email;\n        user.preference = newUser[0].preference;\n        user.free = newUser[0].free === 1 ? true : false;\n        user.skills = [];\n        for (let i = 0; i < newUser.length; i++) {\n          let level = newUser[i].level;\n          let skill = newUser[i].nameSkill;\n          user.skills.push({\n            level,\n            skill\n          });\n        }\n        console.log(\"user modifié\", user);\n        reset(defaultValues);\n        setTimeout(() => {\n          getUser(user);\n          seeHomepage();\n        }, 3000);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\\\"flex-fill d-flex flex-column justify-content-center align-items-center m30\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit(submit),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-column mb10\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          className: \"mb10\",\n          children: \" Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"email\",\n          ...register(\"email\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 25\n        }, this), (errors === null || errors === void 0 ? void 0 : errors.email) && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: `${styles.feedback}`,\n          children: errors.email.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 44\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-column mb10\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"password\",\n          className: \"mb10\",\n          children: \" Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          id: \"password\",\n          ...register(\"password\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 25\n        }, this), (errors === null || errors === void 0 ? void 0 : errors.password) && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: `${styles.feedback}`,\n          children: errors.password.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 47\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 21\n      }, this), feedback && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: `${styles.feedback} mb20`,\n        children: [feedback, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 34\n      }, this), feedbackGood && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: `${styles.feedbackGood} mb20`,\n        children: [feedbackGood, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 38\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        disabled: isSubmitted,\n        children: \"  Submit \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 13\n  }, this);\n}\n_s(Login, \"Yn7Ub7OiOPoBMas1qJxqSMRktZg=\", false, function () {\n  return [useForm];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useFieldArray","useForm","yup","yupResolver","styles","jsxDEV","_jsxDEV","Login","seeHomepage","getUser","_s","feedback","setFeedback","feedbackGood","setFeedbackGood","yupSchema","object","email","string","required","password","defaultValues","register","handleSubmit","reset","formState","errors","isSubmitted","mode","resolver","submit","values","console","log","response","fetch","method","body","JSON","stringify","headers","ok","newUser","json","message","user","username","preference","free","skills","i","length","level","skill","nameSkill","push","setTimeout","className","children","onSubmit","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","type","id","disabled","_c","$RefreshReg$"],"sources":["/Users/kenza/Desktop/aDropOfMilk/Front/src/components/Forms/Login.js"],"sourcesContent":["import React, { useState } from 'react'\nimport { useFieldArray, useForm } from \"react-hook-form\"\nimport * as yup from \"yup\"\nimport { yupResolver } from \"@hookform/resolvers/yup\"\nimport styles from \"./Login.module.scss\"\n\nfunction Login({ seeHomepage, getUser }) {\n    const [feedback, setFeedback] = useState(\"\")\n    const [feedbackGood, setFeedbackGood] = useState(\"\")\n\n    const yupSchema = yup.object({\n        email: yup.string()\n            .required(\"le champ est obligatoire\")\n            .email(\"vous devez saisir un email valide\"),\n        password: yup.string()\n            .required(\"le champ est obligatoire\")\n    })\n\n\n    const defaultValues = {\n        password: \"\",\n        email: \"\",\n    }\n\n    const { register,\n        handleSubmit,\n        reset,\n        formState: { errors, isSubmitted }\n    } = useForm({\n        defaultValues,\n        mode: \"onChange\",\n        resolver: yupResolver(yupSchema)\n    })\n\n\n    const submit = async (values) => {\n        setFeedback(\"\");\n        console.log(values);\n        const response = await fetch(\"http://localhost:8009/api/users/login\", {\n            method: \"POST\",\n            body: JSON.stringify(values),\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n        if (response.ok) {\n            const newUser = await response.json();\n            console.log(\"newUser\", newUser);\n            if (newUser.message) {\n                setFeedback(newUser.message)\n            }\n            else {\n                setFeedbackGood(\"Connexion réussie, vous allez être redirigé\")\n                reset(defaultValues);\n                console.log(\"User recupéré\", newUser);\n                let user = {};\n                user.username = newUser[0].username;\n                user.email = newUser[0].email;\n                user.preference = newUser[0].preference;\n                user.free = newUser[0].free === 1 ? true : false;\n                user.skills = [];\n                for (let i = 0; i < newUser.length; i++) {\n                    let level = newUser[i].level;\n                    let skill = newUser[i].nameSkill;\n                    user.skills.push({level, skill})\n                }\n                console.log(\"user modifié\", user);\n                reset(defaultValues)\n                setTimeout(() => {\n                    getUser(user);\n                    seeHomepage();\n                }, 3000);\n            }\n        }\n    }\n\n        return (\n            <div className='\"flex-fill d-flex flex-column justify-content-center align-items-center m30'>\n                <form onSubmit={handleSubmit(submit)}>\n                    <div className=\"d-flex flex-column mb10\">\n                        <label htmlFor=\"email\" className=\"mb10\"> Email</label>\n                        <input type=\"text\" id=\"email\" {...register(\"email\")} />\n                        {errors?.email && (<p className={`${styles.feedback}`} >{errors.email.message}</p>)}\n                    </div>\n                    <div className=\"d-flex flex-column mb10\">\n                        <label htmlFor=\"password\" className=\"mb10\"> Password</label>\n                        <input type=\"password\" id=\"password\" {...register(\"password\")} />\n                        {errors?.password && (<p className={`${styles.feedback}`} >{errors.password.message}</p>)}\n                    </div>\n    \n                    {feedback && <p className={`${styles.feedback} mb20`}>{feedback} </p>}\n                    {feedbackGood && <p className={`${styles.feedbackGood} mb20`}>{feedbackGood} </p>}\n    \n                    <button className=\"btn btn-primary\" disabled={isSubmitted}>  Submit </button>\n                </form>\n            </div>\n        )\n    }\n\n\nexport default Login\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}